<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Botón Unicornio – Fondo dinámico + hover + touch</title>
<link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet">
<style>
  :root {
    --grad-x: 50%;
    --grad-y: 50%;
    --hue: 0;
    --angle: 135deg;
  }

  body {
    background: #0d0d0d;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    font-family: 'Lato', sans-serif;
  }

  .custom-btn {
    position: relative;
    width: 170px;
    height: 60px;
    border-radius: 20px;
    font-weight: 600;
    cursor: pointer;
    outline: none;
    border: none;
    overflow: visible;
    user-select: none;
    touch-action: none;
    color: #fff;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    box-shadow: inset 2px 2px 8px rgba(0, 0, 0, 0.3),
                inset -2px -2px 8px rgba(255, 255, 255, 0.25);
    transition: transform 0.15s ease, box-shadow 0.4s ease;
    will-change: transform;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: transparent;
  }

  .custom-btn span {
    position: relative;
    z-index: 3;
    display: block;
    width: 100%;
    height: 100%;
    line-height: 60px;
    text-align: center;
  }

  .gradient-bg {
    background:
      linear-gradient(var(--angle),
        hsl(calc(var(--hue) +   0) 100% 50% / 1),
        hsl(calc(var(--hue) +  45) 100% 50% / 1),
        hsl(calc(var(--hue) +  90) 100% 50% / 1),
        hsl(calc(var(--hue) + 135) 100% 50% / 1),
        hsl(calc(var(--hue) + 180) 100% 50% / 1),
        hsl(calc(var(--hue) + 225) 100% 50% / 1),
        hsl(calc(var(--hue) + 270) 100% 50% / 1),
        hsl(calc(var(--hue) + 315) 100% 50% / 1),
        hsl(calc(var(--hue) + 360) 100% 50% / 1)
      );
    background-size: 300% 300%;
    background-position: var(--grad-x) var(--grad-y);
  }

  .custom-btn::before {
    content: '';
    position: absolute;
    top: -20px;
    left: -20px;
    width: calc(100% + 40px);
    height: calc(100% + 40px);
    border-radius: 40px;
    pointer-events: none;
    filter: blur(20px);
    opacity: 0;
    z-index: 1;
    transition: opacity .3s ease;
    will-change: background-position, opacity;
  }

  .custom-btn::after {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    width: calc(100% + 4px);
    height: calc(100% + 4px);
    border-radius: 22px;
    pointer-events: none;
    filter: blur(8px);
    opacity: 0;
    z-index: 2;
    transition: opacity .3s ease;
    will-change: background-position, opacity;
  }

  .custom-btn.active::before,
  .custom-btn.active::after {
    opacity: .9;
  }

  .custom-btn:active {
    transform: scale(0.92);
    box-shadow: inset 4px 4px 12px rgba(0, 0, 0, 0.5),
                inset -4px -4px 12px rgba(255, 255, 255, 0.3);
  }

  .custom-btn:hover {
    box-shadow: inset 2px 2px 10px rgba(0, 0, 0, 0.3),
                inset -2px -2px 10px rgba(255, 255, 255, 0.5),
                0 0 25px rgba(255, 255, 255, 0.3);
  }
</style>
</head>
<body>

<button class="custom-btn"><span>Unicorn</span></button>

<script>
   const btn = document.querySelector('.custom-btn');

  const applyGradientVars = () => {
    const style = getComputedStyle(btn);
    const bx = style.getPropertyValue('--grad-x') || '50%';
    const by = style.getPropertyValue('--grad-y') || '50%';
    const hue = style.getPropertyValue('--hue') || '0';
    const angle = style.getPropertyValue('--angle') || '135deg';

    const g = `
      linear-gradient(${angle},
        hsl(calc(${hue} +   0) 100% 50% / 1),
        hsl(calc(${hue} +  45) 100% 50% / 1),
        hsl(calc(${hue} +  90) 100% 50% / 1),
        hsl(calc(${hue} + 135) 100% 50% / 1),
        hsl(calc(${hue} + 180) 100% 50% / 1),
        hsl(calc(${hue} + 225) 100% 50% / 1),
        hsl(calc(${hue} + 270) 100% 50% / 1),
        hsl(calc(${hue} + 315) 100% 50% / 1),
        hsl(calc(${hue} + 360) 100% 50% / 1)
      )`;
    btn.style.cssText += `
      --grad-x: ${bx};
      --grad-y: ${by};
      --hue: ${hue};
      --angle: ${angle};
      --__g: ${g};
    `;
  };

  const dyn = document.createElement('style');
  dyn.textContent = `
    .custom-btn::before,
    .custom-btn::after{
      background: var(--__g);
      background-size:300% 300%;
      background-position: var(--grad-x) var(--grad-y);
    }
  `;
  document.head.appendChild(dyn);
  applyGradientVars();

  let targetX = 50, targetY = 50;
  let currentX = 50, currentY = 50;
  let isTouching = false;
  let hue = 0;
  let hueSpeedActive = 24 / 60;
  let hueSpeedIdle = 0;
  let driftWhenStill = 0.02;
  let lastMoveTs = 0;

  function animate() {
    const now = performance.now();
    const hSpeed = isTouching ? hueSpeedActive : hueSpeedIdle;
    hue = (hue + hSpeed) % 360;

    if (isTouching && (now - lastMoveTs) > 80) {
      targetX += driftWhenStill;
      if (targetX > 100) targetX = 0;
    }

    currentX += (targetX - currentX) * 0.07;
    currentY += (targetY - currentY) * 0.07;

    btn.style.setProperty('--hue', hue.toFixed(2));
    btn.style.setProperty('--grad-x', currentX.toFixed(2) + '%');
    btn.style.setProperty('--grad-y', currentY.toFixed(2) + '%');
    applyGradientVars();

    requestAnimationFrame(animate);
  }

  function setActive(v) {
    if (v) {
      btn.classList.add('active');
      isTouching = true;
    } else {
      btn.classList.remove('active');
      isTouching = false;
    }
  }

  function updateFromPoint(px, py) {
    const r = btn.getBoundingClientRect();
    targetX = ((px - r.left) / r.width) * 100;
    targetY = ((py - r.top) / r.height) * 100;
    lastMoveTs = performance.now();
  }

  // Evitar menú contextual
  btn.addEventListener('contextmenu', e => e.preventDefault());
  document.addEventListener('contextmenu', e => {
    if (btn.contains(e.target)) e.preventDefault();
  });

  let pressStartedInside = false;

  // --- MOUSE ---
  btn.addEventListener('mousedown', e => {
    pressStartedInside = true;
    setActive(true);
    updateFromPoint(e.clientX, e.clientY);
  });

  // NUEVO: seguir el mouse sin clic
  btn.addEventListener('mouseenter', () => setActive(true));
  btn.addEventListener('mouseleave', () => setActive(false));
  btn.addEventListener('mousemove', e => {
    updateFromPoint(e.clientX, e.clientY);
  });

  window.addEventListener('mouseup', e => {
    if (pressStartedInside) {
      const r = btn.getBoundingClientRect();
      const x = e.clientX, y = e.clientY;
      const releasedInside = x >= r.left && x <= r.right && y >= r.top && y <= r.bottom;
      if (releasedInside) {
        window.location.href = 'https://www.google.com';
      }
    }
    pressStartedInside = false;
    setActive(false);
  });

  // --- TOUCH ---
  btn.addEventListener('touchstart', e => {
    const t = e.touches[0];
    pressStartedInside = true;
    setActive(true);
    updateFromPoint(t.clientX, t.clientY);
  }, { passive: true });

  btn.addEventListener('touchmove', e => {
    const t = e.touches[0];
    updateFromPoint(t.clientX, t.clientY);
  }, { passive: true });

  window.addEventListener('touchend', e => {
    if (pressStartedInside) {
      const t = e.changedTouches[0];
      const r = btn.getBoundingClientRect();
      const x = t.clientX, y = t.clientY;
      const releasedInside = x >= r.left && x <= r.right && y >= r.top && y <= r.bottom;
      if (releasedInside) {
        window.location.href = 'https://www.google.com';
      }
    }
    pressStartedInside = false;
    setActive(false);
  }, { passive: true });

  window.addEventListener('touchcancel', () => {
    pressStartedInside = false;
    setActive(false);
  });

  requestAnimationFrame(animate);
</script>

</body>
</html>

